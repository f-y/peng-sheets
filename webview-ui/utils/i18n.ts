const translations = {
    en: {
        renameSheet: 'Rename Sheet',
        deleteSheet: 'Delete Sheet',
        deleteSheetConfirm: 'Are you sure you want to delete sheet "{0}"?',
        renameDocument: 'Rename Document',
        deleteDocument: 'Delete Document',
        deleteDocumentConfirm: 'Are you sure you want to delete document "{0}"?',
        cancel: 'Cancel',
        delete: 'Delete',
        addDescription: 'Add description...',
        description: 'Description',
        addTable: 'Add Table',
        table: 'Table {0}',
        noTableSelected: 'No Table Selected',
        loading: 'Loading...',
        initializing: 'Initializing Pyodide...',
        newTable: 'New Table',
        insertRowAbove: 'Insert Row Above',
        insertRowBelow: 'Insert Row Below',
        deleteRow: 'Delete Row',
        insertColLeft: 'Insert Column Left',
        insertColRight: 'Insert Column Right',
        deleteCol: 'Delete Column',
        clearCol: 'Clear Column',
        deleteTable: 'Delete Table',
        renameTable: 'Rename Table',
        noSpreadsheetFound: 'No Spreadsheet Found',
        noSpreadsheetMessage:
            'This document does not contain a workbook section yet. Create one to start editing tables.',
        createSpreadsheet: 'Create Spreadsheet',
        toolbarBold: 'Bold',
        toolbarItalic: 'Italic',
        toolbarAlignLeft: 'Align Left',
        toolbarAlignCenter: 'Align Center',
        toolbarAlignRight: 'Align Right',
        toolbarStrikethrough: 'Strikethrough',
        toolbarUnderline: 'Underline',
        displaySettings: 'Display Settings',
        wordWrap: 'Word Wrap',
        numberFormat: 'Number Format',
        formatNone: 'None',
        formatNumber: 'Number',
        formatCurrency: 'Currency',
        formatPercent: 'Percent',
        decimals: 'Decimals',
        thousandsSeparator: 'Thousands Separator',
        currencySymbol: 'Symbol',
        apply: 'Apply',
        columnFormat: 'Column Format',
        toolbarCommaSeparator: 'Thousands Separator',
        toolbarPercent: 'Percent Format',
        toolbarWordWrap: 'Toggle Word Wrap',
        toolbarDecimalIncrease: 'Increase Decimals',
        toolbarDecimalDecrease: 'Decrease Decimals',
        toolbarSave: 'Save',
        toolbarUndo: 'Undo',
        toolbarRedo: 'Redo',
        sortAsc: 'Sort A to Z',
        sortDesc: 'Sort Z to A',
        clearFilter: 'Clear Filter',
        searchPlaceholder: 'Search',
        clickToEdit: 'Click to edit',
        pressEscapeToCancel: 'Press Escape to cancel',
        addNewSheet: 'Add New Sheet',
        addNewDocument: 'Add New Document',
        newSpreadsheet: 'New Spreadsheet',
        dataValidation: 'Data Validation...',
        noValidation: 'No Validation',
        validationList: 'List (Dropdown)',
        validationDate: 'Date (YYYY-MM-DD)',
        validationInteger: 'Integer',
        validationEmail: 'Email',
        validationUrl: 'URL',
        validationType: 'Validation Type',
        listValues: 'Values (one per line)',
        integerRange: 'Range (optional)',
        removeValidation: 'Remove',
        errorMustBeOneOf: 'Must be one of: {0}',
        errorInvalidDate: 'Invalid date format (YYYY-MM-DD)',
        errorMustBeInteger: 'Must be an integer',
        errorMustBeMin: 'Must be >= {0}',
        errorMustBeMax: 'Must be <= {0}',
        errorInvalidEmail: 'Invalid email format',
        errorInvalidUrl: 'Invalid URL format',
        validationTooltipPrefix: 'Data Validation',
        newColumn: 'New Column',
        sheetNamePrefix: 'Sheet',
        documentNamePrefix: 'Document',
        copy: 'Copy',
        cut: 'Cut',
        paste: 'Paste',
        editTableDescription: 'Edit Table Description',
        insertCopiedRowsAbove: 'Insert Copied Row(s) Above',
        insertCopiedRowsBelow: 'Insert Copied Row(s) Below',
        insertCopiedColsLeft: 'Insert Copied Column(s) Left',
        insertCopiedColsRight: 'Insert Copied Column(s) Right',
        selectTable: 'Select Table'
    },
    ja: {
        renameSheet: 'シート名の変更',
        deleteSheet: 'シートを削除',
        deleteSheetConfirm: 'シート "{0}" を削除してもよろしいですか？',
        renameDocument: 'ドキュメント名の変更',
        deleteDocument: 'ドキュメントを削除',
        deleteDocumentConfirm: 'ドキュメント "{0}" を削除してもよろしいですか？',
        cancel: 'キャンセル',
        delete: '削除',
        addDescription: '説明を追加...',
        description: '説明',
        addTable: 'テーブルを追加',
        table: 'テーブル {0}',
        noTableSelected: 'テーブルが選択されていません',
        loading: '読み込み中...',
        initializing: 'Pyodideを初期化中...',
        newTable: '新規テーブル',
        insertRowAbove: '上に行を挿入',
        insertRowBelow: '下に行を挿入',
        deleteRow: '行を削除',
        insertColLeft: '左に列を挿入',
        insertColRight: '右に列を挿入',
        deleteCol: '列を削除',
        clearCol: '列をクリア',
        deleteTable: 'テーブルを削除',
        renameTable: 'テーブル名の変更',
        noSpreadsheetFound: 'スプレッドシートが見つかりません',
        noSpreadsheetMessage:
            'このドキュメントにはまだワークブックセクションがありません。テーブル編集を開始するには作成してください。',
        createSpreadsheet: 'スプレッドシートを作成',
        toolbarBold: '太字',
        toolbarItalic: '斜体',
        toolbarAlignLeft: '左揃え',
        toolbarAlignCenter: '中央揃え',
        toolbarAlignRight: '右揃え',
        toolbarStrikethrough: '取り消し線',
        toolbarUnderline: '下線',
        displaySettings: '表示設定',
        wordWrap: '折り返し',
        numberFormat: '数値フォーマット',
        formatNone: 'なし',
        formatNumber: '数値',
        formatCurrency: '通貨',
        formatPercent: 'パーセント',
        decimals: '小数点桁数',
        thousandsSeparator: '桁区切り',
        currencySymbol: '記号',
        apply: '適用',
        columnFormat: '列フォーマット',
        toolbarCommaSeparator: '桁区切り',
        toolbarPercent: 'パーセント形式',
        toolbarWordWrap: '折り返し切替',
        toolbarDecimalIncrease: '小数点桁数を増やす',
        toolbarDecimalDecrease: '小数点桁数を減らす',
        toolbarSave: '保存',
        toolbarUndo: '元に戻す',
        toolbarRedo: 'やり直し',
        sortAsc: '昇順で並べ替え',
        sortDesc: '降順で並べ替え',
        clearFilter: 'フィルターをクリア',
        searchPlaceholder: '検索',
        clickToEdit: 'クリックして編集',
        pressEscapeToCancel: 'Escキーでキャンセル',
        addNewSheet: '新しいシートを追加',
        addNewDocument: '新しいドキュメントを追加',
        newSpreadsheet: '新しいスプレッドシート',
        dataValidation: 'データ入力規則の設定...',
        noValidation: '制限なし',
        validationList: 'リスト (ドロップダウン)',
        validationDate: '日付 (YYYY-MM-DD)',
        validationInteger: '整数',
        validationEmail: 'メールアドレス',
        validationUrl: 'URL',
        validationType: '入力規則の種類',
        listValues: '値 (1行に1つ)',
        integerRange: '範囲 (任意)',
        removeValidation: '削除',
        errorMustBeOneOf: '次のいずれかを入力してください: {0}',
        errorInvalidDate: '無効な日付形式です (YYYY-MM-DD)',
        errorMustBeInteger: '整数を入力してください',
        errorMustBeMin: '{0} 以上を入力してください',
        errorMustBeMax: '{0} 以下を入力してください',
        errorInvalidEmail: '無効なメールアドレス形式です',
        errorInvalidUrl: '無効なURL形式です',
        validationTooltipPrefix: '入力規則',
        insertCopiedRowsAbove: 'コピーした行を上に挿入',
        insertCopiedRowsBelow: 'コピーした行を下に挿入',
        insertCopiedColsLeft: 'コピーした列を左に挿入',
        insertCopiedColsRight: 'コピーした列を右に挿入',
        newColumn: '新しい列',
        sheetNamePrefix: 'シート',
        documentNamePrefix: 'ドキュメント',
        copy: 'コピー',
        cut: '切り取り',
        paste: '貼り付け',
        editTableDescription: 'このテーブルの説明を編集',
        selectTable: 'テーブルを選択'
    }
};

// Allow 'en' | 'ja' keys.
// We fallback to 'en' for any non-ja language for now.
export type I18nKey = keyof (typeof translations)['en'];

export function t(key: I18nKey, ...args: string[]): string {
    // Expect window.vscodeLanguage to be set by extension
    const lang = (window as Window & { vscodeLanguage?: string }).vscodeLanguage || 'en';
    const locale = lang.startsWith('ja') ? 'ja' : 'en';

    let text =
        translations[locale]?.[key as keyof (typeof translations)['en']] ||
        translations['en'][key as keyof (typeof translations)['en']] ||
        key;

    args.forEach((arg, i) => {
        text = text.replace(`{${i}}`, arg);
    });
    return text;
}
